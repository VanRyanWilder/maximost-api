-- Migration 024: Force Seed 42 (The Master Archive)
-- Hard-flushing and reseeding the Library Habits to correct the '22-Atom' glitch.

-- 1. Truncate Library
TRUNCATE TABLE library_habits CASCADE;

-- 2. Insert 42 Atoms
INSERT INTO library_habits (slug, name, category, type, target_value, unit, icon, theme, description, metadata, how_instruction, why_instruction) VALUES
('daily_steps', 'Daily Steps', 'bio_rig', 'metric', 10000, 'steps', 'Footprints', 'bio_emerald', 'Biological engine maintenance.', '{"visuals": {"icon": "Footprints", "theme": "bio_emerald", "is_ring": true}, "compiler": {"atom": "Movement Baseline", "step": "Incidental movement", "why": "Biological engine maintenance. [Universal]", "expert": "Universal"}, "telemetry": {"auto_verify": true, "terra_metric": "activity.steps", "window": "flexible"}}', 'Incidental movement', 'Biological engine maintenance. [Universal]'),
('morning_sun', 'Morning Sun', 'bio_rig', 'duration', 15, 'minutes', 'Sun', 'bio_emerald', 'Resets the central clock and sleep timer. [Panda]', '{"visuals": {"icon": "Sun", "theme": "bio_emerald"}, "compiler": {"atom": "Photon Anchoring", "step": "Outdoor light within 30m of wake", "why": "Resets the central clock and sleep timer. [Panda]", "canon_ref": "The Circadian Code"}, "telemetry": {"auto_verify": false, "window": "morning"}}', 'Outdoor light within 30m of wake', 'Resets the central clock and sleep timer. [Panda]'),
('fasting', 'Intermittent Fasting', 'bio_rig', 'duration', 16, 'hours', 'Timer', 'asset_lime', 'Triggers autophagy and insulin stability. [Attia]', '{"visuals": {"icon": "Timer", "theme": "asset_lime"}, "compiler": {"atom": "Metabolic Switch", "step": "16-hour fast. Water/Black Coffee only.", "why": "Triggers autophagy and insulin stability. [Attia]", "canon_ref": "Outlive"}}', '16-hour fast. Water/Black Coffee only.', 'Triggers autophagy and insulin stability. [Attia]'),
('sauna', 'Sauna / Heat', 'bio_rig', 'duration', 20, 'minutes', 'Flame', 'combat_red', 'Activates Heat Shock Proteins to prevent decay. [Patrick]', '{"visuals": {"icon": "Flame", "theme": "combat_red"}, "compiler": {"atom": "Hormetic Heat", "step": "Dry sauna at 174°F minimum.", "why": "Activates Heat Shock Proteins to prevent decay. [Patrick]"}}', 'Dry sauna at 174°F minimum.', 'Activates Heat Shock Proteins to prevent decay. [Patrick]'),
('cold_plunge', 'Cold Exposure', 'bio_rig', 'duration', 3, 'minutes', 'Snowflake', 'oxygen_cyan', '250% dopamine increase and mental callousing. [Huberman]', '{"visuals": {"icon": "Snowflake", "theme": "oxygen_cyan"}, "compiler": {"atom": "Cold Shock", "step": "Neck-deep submersion <50°F.", "why": "250% dopamine increase and mental callousing. [Huberman]"}}', 'Neck-deep submersion <50°F.', '250% dopamine increase and mental callousing. [Huberman]'),
('heavy_lifting', 'Heavy Lifting', 'kinetic_core', 'metric', 1, 'session', 'Dumbbell', 'slate_steel', 'Primary predictor of healthspan and integrity. [Galpin]', '{"visuals": {"icon": "Dumbbell", "theme": "slate_steel"}, "compiler": {"atom": "Neural Drive", "step": "Compound movements (Squat/Press).", "why": "Primary predictor of healthspan and integrity. [Galpin]", "canon_ref": "Muscle Physiology"}}', 'Compound movements (Squat/Press).', 'Primary predictor of healthspan and integrity. [Galpin]'),
('deep_work', 'Deep Work', 'kinetic_core', 'duration', 90, 'minutes', 'Zap', 'neural_violet', 'Focus x Time = High Quality Output. [Newport]', '{"visuals": {"icon": "Zap", "theme": "neural_violet"}, "compiler": {"atom": "Cognitive Isolation", "step": "No phone. No internet. Single-task focus.", "why": "Focus x Time = High Quality Output. [Newport]", "canon_ref": "Deep Work"}}', 'No phone. No internet. Single-task focus.', 'Focus x Time = High Quality Output. [Newport]'),
('shadow_audit', 'Shadow Audit', 'black_box', 'boolean', 1, 'audit', 'PenTool', 'warning_amber', 'Data truth is the only path to growth. [Stoic]', '{"visuals": {"icon": "PenTool", "theme": "warning_amber"}, "compiler": {"atom": "Radical Honesty", "step": "5m nightly review of failures/lies.", "why": "Data truth is the only path to growth. [Stoic]"}}', '5m nightly review of failures/lies.', 'Data truth is the only path to growth. [Stoic]'),
('ready_state', 'Ready State', 'bio_rig', 'duration', 10, 'minutes', 'RefreshCw', 'bio_emerald', 'Offset the contractures of 21st-century sitting. [Starrett]', '{"visuals": {"icon": "RefreshCw", "theme": "bio_emerald"}, "compiler": {"atom": "Tissue Maintenance", "step": "Couch stretch and deep squat hold.", "why": "Offset the contractures of 21st-century sitting. [Starrett]", "canon_ref": "Becoming a Supple Leopard"}}', 'Couch stretch and deep squat hold.', 'Offset the contractures of 21st-century sitting. [Starrett]'),
('nasal_breathing', 'Nasal Breathing', 'bio_rig', 'boolean', 1, 'compliance', 'Wind', 'oxygen_cyan', 'Efficient oxygen delivery via the Bohr Effect. [McKeown]', '{"visuals": {"icon": "Wind", "theme": "oxygen_cyan"}, "compiler": {"atom": "Carbon Tolerance", "step": "Nose breathing during sleep/exercise.", "why": "Efficient oxygen delivery via the Bohr Effect. [McKeown]", "canon_ref": "Breath"}}', 'Nose breathing during sleep/exercise.', 'Efficient oxygen delivery via the Bohr Effect. [McKeown]'),
('protein_loading', 'Protein Load', 'bio_rig', 'metric', 30, 'grams', 'Dna', 'asset_lime', 'Threshold required for muscle protein synthesis. [Layman]', '{"visuals": {"icon": "Dna", "theme": "asset_lime"}, "compiler": {"atom": "Leucine Trigger", "step": "30g+ protein in the first meal.", "why": "Threshold required for muscle protein synthesis. [Layman]"}}', '30g+ protein in the first meal.', 'Threshold required for muscle protein synthesis. [Layman]'),
('sleep_hygiene', 'Deep Sleep', 'bio_rig', 'duration', 7.5, 'hours', 'Moon', 'bio_rig', 'Clears amyloid beta neurotoxins from the brain. [Walker]', '{"visuals": {"icon": "Moon", "theme": "bio_rig"}, "compiler": {"atom": "Glymphatic Clearance", "step": "Cool room (65°F). Total darkness.", "why": "Clears amyloid beta neurotoxins from the brain. [Walker]", "canon_ref": "Why We Sleep"}}', 'Cool room (65°F). Total darkness.', 'Clears amyloid beta neurotoxins from the brain. [Walker]'),
('vo2_max', 'VO2 Max', 'telemetry', 'metric', 1, 'session', 'Activity', 'telemetry', 'Strongest correlate to lifespan. [Attia]', '{"visuals": {"icon": "Activity", "theme": "telemetry"}, "compiler": {"atom": "Aerobic Power", "step": "4 mins Max Effort / 4 mins Rest x 4.", "why": "Strongest correlate to lifespan. [Attia]"}}', '4 mins Max Effort / 4 mins Rest x 4.', 'Strongest correlate to lifespan. [Attia]'),
('make_bed', 'Make Bed', 'kinetic_core', 'boolean', 1, 'mission', 'Shield', 'slate_steel', 'First victory establishes the standard. [Jocko]', '{"visuals": {"icon": "Shield", "theme": "slate_steel"}, "compiler": {"atom": "Discipline Baseline", "step": "Precision bed-make upon waking.", "why": "First victory establishes the standard. [Jocko]", "canon_ref": "Extreme Ownership"}}', 'Precision bed-make upon waking.', 'First victory establishes the standard. [Jocko]'),
('prayer_stillness', 'Prayer / Stillness', 'nav_computer', 'duration', 10, 'minutes', 'Heart', 'ghost_white', 'Interrupts the ego; resets Internal Force. [Aurelius]', '{"visuals": {"icon": "Heart", "theme": "ghost_white"}, "compiler": {"atom": "Narrative Control", "step": "10m of meditation or prayer for others.", "why": "Interrupts the ego; resets Internal Force. [Aurelius]", "canon_ref": "Meditations"}}', '10m of meditation or prayer for others.', 'Interrupts the ego; resets Internal Force. [Aurelius]'),
('good_deed', 'Secret Good Deed', 'armor_plating', 'boolean', 1, 'act', 'Heart', 'neural_violet', 'Virtue for its own sake, not for praise. [Aurelius]', '{"visuals": {"icon": "Heart", "theme": "neural_violet"}, "compiler": {"atom": "Character Forge", "step": "One helpful act in total secrecy.", "why": "Virtue for its own sake, not for praise. [Aurelius]"}}', 'One helpful act in total secrecy.', 'Virtue for its own sake, not for praise. [Aurelius]'),
('memento_mori', 'Remember Death', 'armor_plating', 'boolean', 1, 'session', 'Lock', 'ghost_white', 'Kills procrastination instantly. High ground. [Seneca]', '{"visuals": {"icon": "Lock", "theme": "ghost_white"}, "compiler": {"atom": "Perspective Strike", "step": "Reflect for 2m: ''This could be my last day.''", "why": "Kills procrastination instantly. High ground. [Seneca]", "canon_ref": "Letters from a Stoic"}}', 'Reflect for 2m: ''This could be my last day.''', 'Kills procrastination instantly. High ground. [Seneca]'),
('digital_sunset', 'Digital Sunset', 'black_box', 'boolean', 1, 'sunset', 'Moon', 'sunset_indigo', 'Ensures deep REM and hormonal reset. [Walker]', '{"visuals": {"icon": "Moon", "theme": "sunset_indigo"}, "compiler": {"atom": "Melatonin Protection", "step": "Screens off 60m before bed.", "why": "Ensures deep REM and hormonal reset. [Walker]"}}', 'Screens off 60m before bed.', 'Ensures deep REM and hormonal reset. [Walker]'),
('glycemic_defense', 'Glycemic Defense', 'bio_rig', 'boolean', 1, 'day', 'Lock', 'combat_red', 'Reduces systemic inflammation and energy crashes. [Lustig]', '{"visuals": {"icon": "Lock", "theme": "combat_red"}, "compiler": {"atom": "Metabolic Shield", "step": "Zero refined sugar or liquid calories.", "why": "Reduces systemic inflammation and energy crashes. [Lustig]"}}', 'Zero refined sugar or liquid calories.', 'Reduces systemic inflammation and energy crashes. [Lustig]'),
('social_sync', 'Social Sync', 'the_ally', 'boolean', 1, 'call', 'Users', 'maxi_blue', 'Social isolation is a biological stressor. [Conti]', '{"visuals": {"icon": "Users", "theme": "maxi_blue"}, "compiler": {"atom": "Tribe Connection", "step": "Connect with one person for 10+ mins.", "why": "Social isolation is a biological stressor. [Conti]", "canon_ref": "Trauma"}}', 'Connect with one person for 10+ mins.', 'Social isolation is a biological stressor. [Conti]'),
('skill_acquisition', 'Skill Build', 'nav_computer', 'duration', 30, 'minutes', 'BookOpen', 'neural_violet', 'Growth requires both Focus and Novelty. [Huberman]', '{"visuals": {"icon": "BookOpen", "theme": "neural_violet"}, "compiler": {"atom": "Neural Plasticity", "step": "30m focused practice on a high-leverage skill.", "why": "Growth requires both Focus and Novelty. [Huberman]"}}', '30m focused practice on a high-leverage skill.', 'Growth requires both Focus and Novelty. [Huberman]'),
('daily_shutdown', 'Daily Shutdown', 'black_box', 'boolean', 1, 'ritual', 'RotateCcw', 'sunset_indigo', 'Clears attention residue for recovery. [Newport]', '{"visuals": {"icon": "RotateCcw", "theme": "sunset_indigo"}, "compiler": {"atom": "Cognitive Closure", "step": "Review tomorrow''s Big 3. Say ''Shutdown Complete''.", "why": "Clears attention residue for recovery. [Newport]"}}', 'Review tomorrow''s Big 3. Say ''Shutdown Complete''.', 'Clears attention residue for recovery. [Newport]'),
('dead_hang', 'Dead Hang', 'telemetry', 'metric', 120, 'seconds', 'Anchor', 'telemetry', 'Grip strength is the #1 proxy for longevity. [Bohannon]', '{"visuals": {"icon": "Anchor", "theme": "telemetry"}, "compiler": {"atom": "Force Output", "step": "Total of 120s hanging from a bar.", "why": "Grip strength is the #1 proxy for longevity. [Bohannon]"}}', 'Total of 120s hanging from a bar.', 'Grip strength is the #1 proxy for longevity. [Bohannon]'),
('box_breathing', 'Box Breathing', 'armor_plating', 'duration', 5, 'minutes', 'Wind', 'oxygen_cyan', 'Tactical autonomic nervous system regulation. [McKeown]', '{"visuals": {"icon": "Wind", "theme": "oxygen_cyan"}, "compiler": {"atom": "Vagus Nerve Stim", "step": "Inhale 4, Hold 4, Exhale 4, Hold 4.", "why": "Tactical autonomic nervous system regulation. [McKeown]"}}', 'Inhale 4, Hold 4, Exhale 4, Hold 4.', 'Tactical autonomic nervous system regulation. [McKeown]'),
('touch_grass', 'Touch Grass', 'bio_rig', 'duration', 15, 'minutes', 'Trees', 'bio_emerald', 'Fractals reduce rumination and blood pressure. [Bratman]', '{"visuals": {"icon": "Trees", "theme": "bio_emerald"}, "compiler": {"atom": "Panoramic Vision", "step": "15m outside. Look at horizon. No phone.", "why": "Fractals reduce rumination and blood pressure. [Bratman]"}}', '15m outside. Look at horizon. No phone.', 'Fractals reduce rumination and blood pressure. [Bratman]'),
('inbox_zero', 'Inbox Zero', 'kinetic_core', 'boolean', 1, 'process', 'Mail', 'slate_steel', 'Unfinished tasks leak cognitive energy. [Ferriss]', '{"visuals": {"icon": "Mail", "theme": "slate_steel"}, "compiler": {"atom": "Open Loop Closure", "step": "Process inbox until empty. Archive or Task.", "why": "Unfinished tasks leak cognitive energy. [Ferriss]", "canon_ref": "4-Hour Workweek"}}', 'Process inbox until empty. Archive or Task.', 'Unfinished tasks leak cognitive energy. [Ferriss]'),
('digital_air_gap', 'Digital Air Gap', 'black_box', 'duration', 60, 'minutes', 'Lock', 'black_box', 'Severing the connection to the digital hive mind. [Lembke]', '{"visuals": {"icon": "Lock", "theme": "black_box"}, "compiler": {"atom": "Dopamine Reset", "step": "Phone in a separate room during deep work.", "why": "Severing the connection to the digital hive mind. [Lembke]", "canon_ref": "Dopamine Nation"}}', 'Phone in a separate room during deep work.', 'Severing the connection to the digital hive mind. [Lembke]'),
('agency_audit', 'Agency Audit', 'black_box', 'boolean', 1, 'entry', 'Brain', 'nav_computer', 'Regain agency by identifying internal ''spies''. [Conti]', '{"visuals": {"icon": "Brain", "theme": "nav_computer"}, "compiler": {"atom": "Narrative Control", "step": "Journal to identify ''Defense'' vs ''Generative'' drive.", "why": "Regain agency by identifying internal ''spies''. [Conti]"}}', 'Journal to identify ''Defense'' vs ''Generative'' drive.', 'Regain agency by identifying internal ''spies''. [Conti]'),
('leverage_audit', 'Leverage Audit', 'nav_computer', 'boolean', 1, 'review', 'TrendingUp', 'kinetic_core', 'Wealth = Leverage x Judgment. [Naval]', '{"visuals": {"icon": "TrendingUp", "theme": "kinetic_core"}, "compiler": {"atom": "Leverage Check", "step": "Did you use Code, Media, or Capital today?", "why": "Wealth = Leverage x Judgment. [Naval]", "canon_ref": "The Almanack of Naval Ravikant"}}', 'Did you use Code, Media, or Capital today?', 'Wealth = Leverage x Judgment. [Naval]'),
('fasted_walk', 'Fasted Walk', 'bio_rig', 'duration', 20, 'minutes', 'Activity', 'bio_rig', 'Mobilize fatty acids immediately upon waking. [Horowitz]', '{"visuals": {"icon": "Activity", "theme": "bio_rig"}, "compiler": {"atom": "Lipolysis", "step": "20m walk before first calorie.", "why": "Mobilize fatty acids immediately upon waking. [Horowitz]"}}', '20m walk before first calorie.', 'Mobilize fatty acids immediately upon waking. [Horowitz]'),
('cold_bedroom', 'Cold Bedroom', 'bio_rig', 'boolean', 1, 'check', 'Thermometer', 'bio_rig', 'Biological trigger for deep sleep onset. [Walker]', '{"visuals": {"icon": "Thermometer", "theme": "bio_rig"}, "compiler": {"atom": "Core Temp Drop", "step": "Bedroom at 65°F one hour before sleep.", "why": "Biological trigger for deep sleep onset. [Walker]"}}', 'Bedroom at 65°F one hour before sleep.', 'Biological trigger for deep sleep onset. [Walker]'),
('nsdr_reset', 'NSDR / Yoga Nidra', 'bio_rig', 'duration', 20, 'minutes', 'Zap', 'neural_violet', 'Dopamine recovery without sleep. [Huberman]', '{"visuals": {"icon": "Zap", "theme": "neural_violet"}, "compiler": {"atom": "Neural Recharge", "step": "10-20 min audio guide for deep rest.", "why": "Dopamine recovery without sleep. [Huberman]"}}', '10-20 min audio guide for deep rest.', 'Dopamine recovery without sleep. [Huberman]'),
('creatine_load', 'ATP Reservoir', 'bio_rig', 'metric', 5, 'grams', 'Zap', 'asset_lime', 'Increases anaerobic power and brain function. [Attia]', '{"visuals": {"icon": "Zap", "theme": "asset_lime"}, "compiler": {"atom": "Cognitive Fuel", "step": "5g Creatine Monohydrate daily.", "why": "Increases anaerobic power and brain function. [Attia]"}}', '5g Creatine Monohydrate daily.', 'Increases anaerobic power and brain function. [Attia]'),
('taking_souls', 'Taking Souls', 'kinetic_core', 'boolean', 1, 'mission', 'Flame', 'combat_red', 'Override the brain''s safety governor. [Goggins]', '{"visuals": {"icon": "Flame", "theme": "combat_red"}, "compiler": {"atom": "Mental Callousing", "step": "Train until the mind wants to quit.", "why": "Override the brain''s safety governor. [Goggins]"}}', 'Train until the mind wants to quit.', 'Override the brain''s safety governor. [Goggins]'),
('cookie_jar', 'The Cookie Jar', 'telemetry', 'boolean', 1, 'reflection', 'Trophy', 'warning_amber', 'Fuel for current struggle. [Goggins]', '{"visuals": {"icon": "Trophy", "theme": "warning_amber"}, "compiler": {"atom": "Past Victories", "step": "Recall a moment of immense suffering you overcame.", "why": "Fuel for current struggle. [Goggins]"}}', 'Recall a moment of immense suffering you overcame.', 'Fuel for current struggle. [Goggins]'),
('accountability_mirror', 'Accountability Mirror', 'black_box', 'boolean', 1, 'audit', 'Eye', 'ghost_white', 'Strip the ego to see the raw data truth. [Goggins]', '{"visuals": {"icon": "Eye", "theme": "ghost_white"}, "compiler": {"atom": "Raw Truth", "step": "Face the mirror. State your insecurities.", "why": "Strip the ego to see the raw data truth. [Goggins]"}}', 'Face the mirror. State your insecurities.', 'Strip the ego to see the raw data truth. [Goggins]'),
('carbon_tolerance', 'Breath Control', 'telemetry', 'metric', 60, 'seconds', 'Wind', 'oxygen_cyan', 'Proxy for CO2 tolerance and stress resilience. [Mackenzie]', '{"visuals": {"icon": "Wind", "theme": "oxygen_cyan"}, "compiler": {"atom": "Exhale Timer", "step": "Measure the duration of a single exhale.", "why": "Proxy for CO2 tolerance and stress resilience. [Mackenzie]"}}', 'Measure the duration of a single exhale.', 'Proxy for CO2 tolerance and stress resilience. [Mackenzie]'),
('recovery_sync', 'Recovery Sync (AA)', 'the_ally', 'boolean', 1, 'meeting', 'Sun', 'maxi_blue', 'Honoring the 6.5 Year Mission. Isolation is drift.', '{"visuals": {"icon": "Sun", "theme": "maxi_blue"}, "compiler": {"atom": "Sovereign Spirit", "step": "Attend meeting or Outreach/Service.", "why": "Honoring the 6.5 Year Mission. Isolation is drift.", "expert": "Founder"}}', 'Attend meeting or Outreach/Service.', 'Honoring the 6.5 Year Mission. Isolation is drift.'),
('amor_fati', 'Amor Fati', 'armor_plating', 'boolean', 1, 'acceptance', 'RefreshCw', 'ghost_white', 'The hindrance is the path. [Aurelius]', '{"visuals": {"icon": "RefreshCw", "theme": "ghost_white"}, "compiler": {"atom": "Love of Fate", "step": "Embrace a current obstacle as necessary fuel.", "why": "The hindrance is the path. [Aurelius]"}}', 'Embrace a current obstacle as necessary fuel.', 'The hindrance is the path. [Aurelius]'),
('dichotomy_control', 'Control Audit', 'armor_plating', 'boolean', 1, 'logic', 'Shield', 'ghost_white', 'Zero energy leak on things you cannot change. [Epictetus]', '{"visuals": {"icon": "Shield", "theme": "ghost_white"}, "compiler": {"atom": "Internal Focus", "step": "Discard 3 external worries outside your control.", "why": "Zero energy leak on things you cannot change. [Epictetus]"}}', 'Discard 3 external worries outside your control.', 'Zero energy leak on things you cannot change. [Epictetus]'),
('sleep_cocktail', 'Neuro-Downreg', 'bio_rig', 'boolean', 1, 'compliance', 'Moon', 'neural_violet', 'Reduce sleep latency and improve quality. [Huberman]', '{"visuals": {"icon": "Moon", "theme": "neural_violet"}, "compiler": {"atom": "Sleep Stack", "step": "Mg Threonate + Theanine 60m pre-bed.", "why": "Reduce sleep latency and improve quality. [Huberman]"}}', 'Mg Threonate + Theanine 60m pre-bed.', 'Reduce sleep latency and improve quality. [Huberman]'),
('forty_percent', '40% Override', 'kinetic_core', 'boolean', 1, 'push', 'Zap', 'combat_red', 'The mind quits long before the body. [Goggins]', '{"visuals": {"icon": "Zap", "theme": "combat_red"}, "compiler": {"atom": "Governor Bypass", "step": "Push for 5 more mins/reps when ''done''.", "why": "The mind quits long before the body. [Goggins]"}}', 'Push for 5 more mins/reps when ''done''.', 'The mind quits long before the body. [Goggins]')
ON CONFLICT (slug) DO UPDATE SET
    name = EXCLUDED.name,
    category = EXCLUDED.category,
    type = EXCLUDED.type,
    target_value = EXCLUDED.target_value,
    unit = EXCLUDED.unit,
    icon = EXCLUDED.icon,
    theme = EXCLUDED.theme,
    description = EXCLUDED.description,
    metadata = EXCLUDED.metadata,
    how_instruction = EXCLUDED.how_instruction,
    why_instruction = EXCLUDED.why_instruction;
